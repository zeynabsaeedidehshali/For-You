<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ’– Happy Birthday, My Love</title>
<style>
  :root{
    --bg1:#ffd6f0; --bg2:#f5c2ff; --bg3:#d8b4fe;
    --ink1:#7a115f; --ink2:#5c1851; --ink3:#6a124e;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; overflow:hidden;
    display:flex; align-items:center; justify-content:center; flex-direction:column;
    background: radial-gradient(circle at center, var(--bg1) 0%, var(--bg2) 45%, var(--bg3) 100%);
    font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  }
  canvas.bg-layer{ position:fixed; inset:0; pointer-events:none; z-index:0; }

  /* Foreground */
  .content{
    position:relative; z-index:2;
    display:flex; align-items:center; justify-content:center; flex-direction:column;
    gap:14px; padding:10px; width:100%; max-width:1200px;
  }
  /* Pulsing heart stays outside box */
  #heartBtn{
    font-size: clamp(60px,15vw,140px);
    cursor:pointer; user-select:none;
    animation: pulse 1.5s infinite;
    filter: drop-shadow(0 10px 25px rgba(122,17,95,.3));
  }
  @keyframes pulse{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.2)} }

  /* Text box for readability */
  .text-box{
    background: rgba(255,255,255,0.78);
    backdrop-filter: blur(6px);
    border: 1px solid rgba(255,255,255,0.7);
    box-shadow: 0 12px 40px rgba(122,17,95,0.18);
    border-radius: 22px;
    padding: clamp(16px, 3.5vw, 28px);
    max-width: min(920px, 92vw);
    text-align:center;
  }
  h1{
    font-size: clamp(32px,7vw,72px);
    margin:0; color:var(--ink1);
    text-shadow:0 2px 14px rgba(255,118,182,.25);
  }
  p.lead{
    font-size:clamp(18px,4vw,28px);
    margin:10px 0 14px; color:var(--ink2);
  }
  #msg{
    font-size:clamp(20px,4.5vw,32px);
    color:var(--ink3);
    opacity:0; transform:translateY(14px);
    transition:opacity .6s ease, transform .6s ease;
  }
  #msg.show{opacity:1; transform:translateY(0)}
</style>
</head>
<body>
  <!-- BACKGROUND CANVASES -->
  <canvas id="bg" class="bg-layer"></canvas>
  <canvas id="confetti" class="bg-layer"></canvas>

  <!-- FOREGROUND CONTENT -->
  <div class="content" aria-live="polite">
    <div id="heartBtn" aria-label="Heart">ğŸ’–</div>
    <div class="text-box">
      <h1>Happy Birthday, my love ğŸ’–</h1>
      <p class="lead">My heart beats happiest with you ğŸ’•</p>
      <div id="msg">I love you more than all the stars âœ¨, all the songs ğŸ¶, and every heartbeat â¤ï¸. Happy Birthday, my forever. ğŸ’•ğŸ’œğŸ’˜ğŸ˜˜</div>
    </div>
  </div>

<script>
// ---------- Sprite cache for emojis ----------
function makeEmojiCanvas(char, size){
  const c = document.createElement('canvas');
  const pad = Math.ceil(size*0.4);
  c.width = c.height = size + pad*2;
  const g = c.getContext('2d');
  g.textAlign = 'center'; g.textBaseline = 'middle';
  g.font = size + 'px serif';
  g.fillText(char, c.width/2, c.height/2);
  return c;
}
const glyphCache = new Map();
function getGlyph(char, size){
  const key = char + '@' + Math.round(size);
  if(!glyphCache.has(key)){ glyphCache.set(key, makeEmojiCanvas(char, Math.round(size))); }
  return glyphCache.get(key);
}

// ---------- Emoji tunnel background ----------
const bg = document.getElementById('bg');
const ctx = bg.getContext('2d');
let W,H,cx,cy;
function resizeBG(){ W=bg.width=innerWidth; H=bg.height=innerHeight; cx=W/2; cy=H/2; }
resizeBG(); addEventListener('resize',resizeBG);

const EMOJIS = ["â¤ï¸","ğŸ’–","ğŸ’œ","ğŸ’•","ğŸ’˜","ğŸ’","ğŸ˜˜","ğŸ˜š","ğŸ˜™","ğŸ˜—","â­","âœ¨"];
let sprites = [];
const SPRITE_COUNT = 150;
for(let i=0;i<SPRITE_COUNT;i++){ sprites.push(resetSprite({})); }
function resetSprite(s){
  s.angle=Math.random()*Math.PI*2;
  s.radius=0.35+Math.random()*1;
  s.z=1+Math.random()*3.2;
  s.char=EMOJIS[(Math.random()*EMOJIS.length)|0];
  s.size=16+Math.random()*22;
  s.spin=(Math.random()<.5?-1:1)*(0.002+Math.random()*0.006);
  s.speed=0.012+Math.random()*0.018;
  return s;
}
function loopBG(){
  ctx.clearRect(0,0,W,H);
  for(const s of sprites){
    s.angle+=s.spin; s.z-=s.speed;
    if(s.z<=0.05) resetSprite(s), s.z=3.2;
    const tubeR=Math.min(W,H)*0.45;
    const k=tubeR*s.radius/s.z;
    const x=cx+Math.cos(s.angle)*k;
    const y=cy+Math.sin(s.angle)*k;
    const size=s.size*(1.6/s.z);
    const glyph = getGlyph(s.char, size);
    ctx.drawImage(glyph, x - glyph.width/2, y - glyph.height/2);
  }
  requestAnimationFrame(loopBG);
}
requestAnimationFrame(loopBG);

// ---------- Confetti bursts (behind text) ----------
const conf=document.getElementById('confetti');
const c2=conf.getContext('2d');
let W2,H2; function resizeC(){ W2=conf.width=innerWidth; H2=conf.height=innerHeight; } resizeC(); addEventListener('resize',resizeC);

let pieces=[];
function addConfetti(n=110, origin={x:innerWidth/2,y:innerHeight/2}){
  for(let i=0;i<n;i++){
    pieces.push({x:origin.x,y:origin.y,
      vx:(Math.random()*2-1)*6.5, vy:(Math.random()*-1-1)*7.5,
      g:0.22+Math.random()*0.09,
      char:EMOJIS[(Math.random()*EMOJIS.length)|0],
      size:22+Math.random()*26,
      life:150+Math.random()*120
    });
  }
}
function loopConfetti(){
  c2.clearRect(0,0,W2,H2);
  pieces=pieces.filter(p=>(p.life-=1)>0 && p.y<H2+40);
  for(const p of pieces){
    p.vy+=p.g; p.x+=p.vx; p.y+=p.vy;
    const glyph = getGlyph(p.char, p.size);
    c2.drawImage(glyph, p.x - glyph.width/2, p.y - glyph.height/2);
  }
  requestAnimationFrame(loopConfetti);
}
requestAnimationFrame(loopConfetti);

// ---------- Interactions ----------
const btn=document.getElementById('heartBtn');
const msg=document.getElementById('msg');

btn.addEventListener('click',()=>{
  msg.classList.add('show');
  addConfetti(200,{x:innerWidth/2,y:innerHeight/2.1});
});
document.addEventListener('click',e=>{
  if(e.target===btn) return;
  addConfetti(90,{x:e.clientX,y:e.clientY});
});
setTimeout(()=> addConfetti(90,{x:innerWidth/2,y:innerHeight/1.25}), 700);
</script>
</body>
</html>
